@model IEnumerable<BookCardModel>
@using CalibreLib.Views.Shared.Components

<h2>Books</h2>
@await Component.InvokeAsync(typeof(ToolbarComponent), new { type = EPageToolbarType.BookCardGrid })
<div id="mainCardGrid">
    @{

        var strHeader = @"<div class=""container-fluid row display-flex"">
            <div id=""cardGridRow"" class=""row"">";
        ViewContext.Writer.WriteLine(strHeader);

        await Html.RenderPartialAsync("~/Views/Shared/Components/BookCardGridRecords.cshtml", Model);

        var strFooter = @"</div>
        </div>";
        ViewContext.Writer.WriteLine(strFooter);
    }
</div>
<div class="row">  
    <div id="loading" style="text-align:center; padding:0 0 0 0">  
        <img src='~/images/loading.gif' />  
    </div>  
</div>
<div id="paginationToolbar" class="visually-hidden">    
    <button class="btn btn-outline-primary" for="btnPrev" onclick="pagingNavigation('Prev');">Prev</button>
    <input type="text" autocomplete="false" inputmode="numeric" id="lblPageNum" class="fw-bold p-1" style="width:50px;" value="1" />
    <button class="btn btn-outline-primary" for="btnNext" onclick="pagingNavigation('Next');">Next</button>
    <label id="lblPageCount" class="fw-bold p-3"></label>
</div>
<script type="text/javascript" src="js/cardgrid.js" asp-append-version="true"></script>
<script type="text/javascript">
    window.addEventListener('load', function () {
        $("div#loading").hide();
        const storedPagingEnabledValue = (localStorage.getItem('gridPagingEnabled') === 'true');
        togglePagingEnabled(storedPagingEnabledValue);
        const storedSortBy = localStorage.getItem('gridSortBy');
        $('#' + storedSortBy)[0].checked = true;
        $('#lblPageSize')[0].value = localStorage.getItem('gridPageSize') ?? 10;
        loadBooks(ajaxCallUrl);
        $(window).scroll(scrollHandler);
    });
</script>

